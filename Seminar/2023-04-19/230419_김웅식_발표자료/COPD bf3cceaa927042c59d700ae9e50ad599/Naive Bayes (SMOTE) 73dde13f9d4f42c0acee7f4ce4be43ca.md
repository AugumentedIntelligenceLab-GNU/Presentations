# Naive Bayes (SMOTE)

![Untitled](Naive%20Bayes%20(SMOTE)%2073dde13f9d4f42c0acee7f4ce4be43ca/Untitled.png)

위 식은 Bayes 법칙인데 사전확률과 사후확률간의 관계를 설명하는 법칙임. 각 수식을 설명하자면

P(b | a) → 사건 a가 발생한 후, 갱신된 사건 b의 확률

P(b) → 사건 a가 발생하기 전에 가지고 있던 사건 b의 확률

P(a | b) → 사건 b가 발생한 경우 사건 a의 확률

P(a) → 확률의 크기 조정, 정규화 상수

| 김웅식 | 남자 |
| --- | --- |
| 김웅식 | 여자 |
| 김웅식 | 남자 |
| 황승현 | 남자 |
| 황승현 | 여자 |
| 황승현 | 남자 |
| 황승현 | 여자 |
| 황승현 | 여자 |

김웅식이라는 사람이 남자일 확률을 구하자면 $P(남자 | 김웅식)$

$P(남자 | 김웅식)$을 계산해보면

$P(남자) * P(김웅식 | 남자) / P(김웅식)$

P(남자) = 4 / 8

P(김웅식 | 남자) = 2 / 4

정규화 상수를 제외하면 ⇒ 0.25

P(여자|김웅식)을 계산해보면

P(여자) = 4 / 8

P(김웅식 | 여자) = 1 / 4

정규화 상수를 제외하면 ⇒ 0.125

즉, 김웅식은 남자라고 예측함.

Naive Bayes는 Bayes 법칙에 기반한 방법.

multi-class 분류에서 예측하기에 좋음.

단, 특성들 간의 독립이라는 가정하에 만들어진 모델이기에 실제 적용에서는 완전하게 독립적인 상황이 많지 않아, 사용에 어려움이 있음

---

## SMOTE 사용

```python
handler.test
```

|  | tn | fp | fn | tp | accuracy | precision | recall | f1\_score |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| test | 64 | 61 | 49 | 76 | 0.560 | 0.554745 | 0.608 | 0.580153 |
| test | 66 | 59 | 43 | 82 | 0.592 | 0.581560 | 0.656 | 0.616541 |
| test | 57 | 68 | 38 | 87 | 0.576 | 0.561290 | 0.696 | 0.621429 |
| test | 54 | 71 | 38 | 87 | 0.564 | 0.550633 | 0.696 | 0.614841 |
| test | 66 | 59 | 42 | 83 | 0.596 | 0.584507 | 0.664 | 0.621723 |

```python
handler.mean
```

|  | <unnamed> |
| --- | --- |
| tn | 61.400000 |
| fp | 63.600000 |
| fn | 42.000000 |
| tp | 83.000000 |
| accuracy | 0.577600 |
| precision | 0.566547 |
| recall | 0.664000 |
| f1\_score | 0.610937 |

```python
handler.train
```

|  | tn | fp | fn | tp | accuracy | precision | recall | f1\_score |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| train | 1060 | 881 | 184 | 1757 | 0.725657 | 0.666035 | 0.905204 | 0.767416 |
| train | 995 | 946 | 183 | 1758 | 0.709171 | 0.650148 | 0.905719 | 0.756943 |
| train | 1037 | 904 | 230 | 1711 | 0.707883 | 0.654302 | 0.881504 | 0.751097 |
| train | 923 | 1018 | 180 | 1761 | 0.691396 | 0.633681 | 0.907264 | 0.746186 |
| train | 1058 | 883 | 225 | 1716 | 0.714580 | 0.660254 | 0.884080 | 0.755947 |

## SMOTE 비사용

```python
handler2.test
```

|  | tn | fp | fn | tp | accuracy | precision | recall | f1\_score |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| test | 83 | 42 | 52 | 73 | 0.624 | 0.634783 | 0.584 | 0.608333 |
| test | 80 | 45 | 55 | 70 | 0.600 | 0.608696 | 0.560 | 0.583333 |
| test | 86 | 39 | 57 | 68 | 0.616 | 0.635514 | 0.544 | 0.586207 |
| test | 78 | 47 | 55 | 70 | 0.592 | 0.598291 | 0.560 | 0.578512 |
| test | 82 | 43 | 52 | 73 | 0.620 | 0.629310 | 0.584 | 0.605809 |

```python
handler2.mean
```

|  | <unnamed> |
| --- | --- |
| tn | 120.000000 |
| fp | 5.000000 |
| fn | 106.000000 |
| tp | 19.000000 |
| accuracy | 0.556000 |
| precision | 0.792886 |
| recall | 0.152000 |
| f1\_score | 0.253891 |

```python
handler2.train
```

|  | tn | fp | fn | tp | accuracy | precision | recall | f1\_score |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| train | 1352 | 589 | 152 | 222 | 0.679914 | 0.273736 | 0.593583 | 0.374684 |
| train | 1334 | 607 | 143 | 231 | 0.676026 | 0.275656 | 0.617647 | 0.381188 |
| train | 1383 | 558 | 152 | 222 | 0.693305 | 0.284615 | 0.593583 | 0.384749 |
| train | 1339 | 602 | 144 | 230 | 0.677754 | 0.276442 | 0.614973 | 0.381426 |
| train | 1318 | 623 | 141 | 233 | 0.669978 | 0.272196 | 0.622995 | 0.378862 |